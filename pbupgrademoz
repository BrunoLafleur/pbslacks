#! /bin/sh

# Auteur : Pierre Brochard (pierre.brochard.1982@m4x.org)
# Date : 2019
# License : See the LICENSE file in this repository.

if [ ! $UID = 0 ]; then
  cat << EOF
This script must be run as root.
EOF
  exit 1
fi

xhelp () {
    cat <<EOF
Script a lancer dans le repertoire contenant slackware64 fraichement aspire.
pbslacks doit aussi etre accessible du repertoire courant.

Launch this script in the directory including slackware64.
pbslacks should also be there.

  > cd .../slackware-current
or> cd /run/media/$USER/USBSLACKINS/SlackDVD
  > pbslacks/pbupgrademoz
EOF
}

if [ ! -d slackware64 -o '(' ! -h pbslacks -a ! -d pbslacks ')' ] ;then
    xhelp
    exit 1
fi

MYPWD=$(pwd)
HOMESLACK="$MYPWD"
HOMEMOZ=/usr/lib64

FFVERSION=$(ls "$HOMESLACK/packages/Mozilla/firefox-"*"esr.tar.bz2")
THVERSION=$(ls "$HOMESLACK/packages/Mozilla/thunderbird-"*".tar.bz2")

installmoz () {
    PROD="$1"
    VERSION="$2"
    if [ -f "$VERSION" ] ;then
	rm -rf $HOMEMOZ/${PROD}.en
	mv $HOMEMOZ/$PROD $HOMEMOZ/${PROD}.en
	cd $HOMEMOZ
	tar xfj "$VERSION"
    fi
}

installmoz firefox "$FFVERSION"
installmoz thunderbird "$THVERSION"

echo "Firefox et Thunderbird en français ajoutés"
cd "$MYPWD"
